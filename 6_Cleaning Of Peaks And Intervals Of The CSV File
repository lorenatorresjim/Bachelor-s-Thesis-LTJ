##### SCRIPT FOR CLEANING THE PEAKS AND INTERVALS CSV FILE 
 
import pandas as pd 
import ast   
import os 
import re 
 
# Load the file 
original_file = r"C:\Users\loren\Downloads\TFG MITBIH 
TRAIN\time_peaks_intervals.csv" 
df = pd.read_csv(original_file) 
 
# Function to clean peaks and intervals 
def limpiar_pico(valor): 
    try: 
        if isinstance(valor, str): 
            valor = valor.strip("[]").strip() 
            valor = re.sub(r'\s+', ',', valor) if " " in valor and "," 
not in valor else valor 
            lista = list(map(int, valor.split(','))) if valor else [] 
        else: 
            lista = valor 
        
        if isinstance(lista, list) and lista: 
            return max(lista)  # We return the maximum value from the 
list 
        else: 
            return "NaN"  # If the list is empty or not a list, return 
NaN 
    except: 
        return "NaN"  # If there's an error in processing, return NaN 
 
# Apply this function to columns 
columnas_a_limpiar = ["Picos R", "Picos P", "Picos Q", "Picos S", 
"Picos T", "Intervalos QRS", "Intervalos PR", "Intervalos QT"] 
for col in columnas_a_limpiar: 
    df[col] = df[col].apply(limpiar_pico) 
 
#Save file 
directorio_origen = os.path.dirname(original_file) 
clean_file = os.path.join(directorio_origen, 
"time_peaks_intervals_clean.csv") 
df.to_csv(clean_file, index=False) 
 
print(f"Clean file saved in: {clean_file}")
